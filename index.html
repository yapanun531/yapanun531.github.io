<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="inputBox">
        <select class="form-select" name="name" id="name" required></select>
        <span>請選擇</span>
    </div>
    <div class="inputBox">
        <input type="text" id="account" required>
        <span>帳號:</span>
        <div id="accountError" class="error-message" style="color: #ff3860;"></div>
    </div>
    <div class="inputBox">
        <input type="password" id="password" required>
        <span>密碼:</span>
        <div id="passwordError" class="error-message" style="color: #ff3860;"></div>
    </div>
    <div>
        <button type="button" class="btn" onclick="sendData()">確認</button>
    </div>
</body>

<script type="text/javascript">
    var names = ['葉羿宏', '陳冠綸', '潘建宏', '凱德爾', '威爾森', '陳柏丞', '莊博元', '莊瑋杰', '陳慶達', '陳晉垣', '黃致銘', '林冠融', '彭冠綸', '張傑程', '山米爾', '江均', '李譽宸', '鄭懷謙'];
    var nameSelect = document.getElementById("name");
    var inner = "";
    for (var i = 0; i < names.length; i++) {
        inner = inner + '<option value=' + names[i] + '>' + names[i] + '</option>';
    }
    nameSelect.innerHTML = inner;

    const account = document.getElementById('account');
    const password = document.getElementById('password');


    function sendData() {
        const accountValue = account.value.trim();
        const passwordValue = password.value.trim();
        const nameValue = document.getElementById('name').value.trim();
        const containsLetterAndNumber = /^(?=.*\d)(?=.*[a-zA-Z])[a-zA-Z0-9]+$/.test(passwordValue);
        if (accountValue === "") {
            document.getElementById("accountError").innerText = "請輸入帳號";
        }
        else {
            document.getElementById("accountError").innerText = "";
        }
        if (passwordValue === "") {
            document.getElementById("passwordError").innerText = "請輸入密碼";
        }
        else if (passwordValue.length < 6) {
            document.getElementById("passwordError").innerText = "密碼長度必須大於6";
        }
        else if (!containsLetterAndNumber) {
            document.getElementById("passwordError").innerText = "密碼必須包含至少一個英文字母和數字，且不支援特殊符號";
        }
        else {
            document.getElementById("passwordError").innerText = "";
        }
        if (accountValue && passwordValue.length >= 6 && containsLetterAndNumber) {
            Telegram.WebApp.ready();
            Telegram.WebApp.MainButton.setText('註冊').show().onClick(function () {
                const data = JSON.stringify({ account: accountValue, name: nameValue, password: passwordValue });
                Telegram.WebApp.sendData(data);
                Telegram.WebApp.close();
            });
        }
    }

    Telegram.WebApp.expand();
</script>

</html>
